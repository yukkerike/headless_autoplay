# Headless autoplay

## Приступая к работе

Для работы программы необходимо установить среду [node.js](https://nodejs.org/ru/download/)

### Подготовка к запуску

Перед первым запуском необходимо:

* Скачать репозиторий любым из удобных для вас способов, например из [релизов](https://github.com/yukkerike/headless_autoplay/releases/latest)
* Заполнить [config.json](config.json)
* Запустить один из файлов [Запуск.sh](Запуск.sh.json) или [Запуск.bat](Запуск.bat) в соответствии с вашей ОС

Сниффер запускается командой __npm run sniff__

### Конфигурирование

Осуществляется с помощью редактирования файла [config.json](config.json) перед запуском.

Поле __"players"__ представлено массивом. В него добавляются аккаунты, для которых автоплеер будет запущен.
Внутри массива __"players"__ есть обязательное поле __"session"__, которое содержит токен игрока в query формате.

Есть возможность задать настройки по умолчанию сразу для всех аккаунтов. Их нужно заносить в кортеж __"defaults"__. 
У настроек конкретного игрока есть приоритет над глобальными настройками, то есть они перезаписывают умолчания.

В стандартном конфиге настройки расположены в порядке приоритета, с которым они будут применены.
Например, у __playInClan__ есть приоритет над __locationId__.

Токен можно получить букмарклетом 
```
javascript:(function(){var _=prompt('',document.getElementById('flash-app').childNodes[1].value)})()
```

Остальные настройки:
```
"reconnect": true|false - переподключаться при разрывах.
"session": "" – токен.
"checkModerators": true|false – выходить с карты при обнаружении модераторов.
"autoPlay": true|false – включить автоплеер.
"playInClan": true|false - играть в клане.
"locationId": 4 – id локации в которой будет запускаться автоплеер .
    (сд - 0, 
    топи - 2, 
    испытания - 9, 
    пустыня - 3, 
    аз - 4, 
    шторм - 13, 
    дз - 5, 
    битва - 10, 
    стадион - 15)
"surrender": true|false – включение капитуляции (тогда белка будет заходить в дупло за 10 секунд до конца раунда).
"roomId": 0 – id комнаты в клане.
"joinId": 0 – id игрока, к которму будет осуществляться присоединение.
"clanIdToJoin": 0 – id клана, в который будет подана заявка. 
                    Если опора тоже участвует в автокаче, то заявка будет одобрена автоматически.
"donateLevel": 0 – уровень, по достижению которого белка внесёт все свои орехи и монеты в клан и выйдет из него.
```

## Основано на библиотеках

* [sq-lib](https://github.com/sovlet/sq-lib/) - Библиотека для работы с протоколом игры "Трагедия белок"

## Лицензия

Проект наследует лицензию GPL V2.0 библиотеки [sq-lib](https://github.com/sovlet/sq-lib/) - за подробностями смотрите файл [LICENSE](LICENSE)
